/**
    The game logic for Pong
    Pong is played with two paddles on opposite sides of the screen. Players rally the ball until it passes a paddle,
    Where the opposing player scores a point
    play continues until 21 points, and the winner is announced
**/

class PongGame {
    field Ball ball; //the ball between players
    field Player left; //the left paddle
    field Player right; //the right paddle
    field int leftScore; //the current score of the left player
    field int rightScore; //the current score of the right player

    constructor PongGame new() {
        //initialize the parts of the game
        let leftScore = 0;
        let rightScore = 0;
        let ball = Ball.new(1, 2);
        return this;
    }

    method void dispose() {
        do Memory.deAlloc(this);
        return;
    }

    method void run() {
        var boolean oob;
        let oob = false;
        do showScore();
        while (~oob) {
            let oob = ball.update();
            do Sys.wait(10);
        }
        let leftScore = leftScore + 1;
        do showScore();
        return;
    }

    method void showScore() {
        do Screen.drawLine(255, 0, 255, 255);
        do Output.moveCursor(0, 31);
        do Output.printInt(left);
        do Output.printString("-");
        do Output.printInt(right);
        return;
    }
}
